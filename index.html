<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klasifikační hra</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
        .container {
            max-width: 900px;
        }
        .card {
            background-color: white;
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .button {
            transition: transform 0.1s ease-in-out, box-shadow 0.1s ease-in-out;
            cursor: pointer;
        }
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .correct {
            background-color: #d1fae5;
            color: #065f46;
        }
        .incorrect {
            background-color: #fee2e2;
            color: #991b1b;
        }
        .message-box {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 sm:p-8">

    <div id="game-container" class="container mx-auto">
        <!-- Úvodní obrazovka -->
        <div id="start-screen" class="card text-center transition-opacity duration-500">
            <h1 class="text-3xl sm:text-4xl font-bold mb-4">Klasifikační hra</h1>
            <p class="mb-6 text-gray-600">Otestuj si své znalosti klasifikace organismů. Hra má 4 kola, ve kterých budeš zařazovat živočichy, rostliny a houby do správných skupin, řádů a čeledí a nakonec je i pojmenovat.</p>
            <button onclick="startGame()" class="button bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-full text-lg">
                Spustit hru
            </button>
        </div>

        <!-- Herní obrazovka -->
        <div id="game-screen" class="card hidden">
            <h2 id="round-title" class="text-2xl sm:text-3xl font-bold mb-4 text-center"></h2>
            <div id="species-info" class="text-center mb-6">
                <h3 id="species-name" class="text-xl sm:text-2xl font-semibold text-blue-800 mb-2"></h3>
                <p id="species-description" class="text-gray-600 italic"></p>
            </div>
            
            <div id="question-area" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <!-- Tlačítka pro volbu nebo textové pole se objeví zde -->
            </div>

            <div id="feedback-message" class="message-box text-center p-4 mt-6 rounded-lg text-lg font-semibold hidden"></div>
            
            <div class="flex justify-center mt-6">
                <button id="next-button" onclick="nextQuestion()" class="button bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-full hidden">
                    Pokračovat
                </button>
            </div>
        </div>

        <!-- Závěrečná obrazovka -->
        <div id="end-screen" class="card text-center hidden transition-opacity duration-500">
            <h2 class="text-3xl sm:text-4xl font-bold mb-4">Konec hry!</h2>
            <p id="final-score" class="text-xl mb-6 text-gray-700"></p>
            <p class="mb-6 text-gray-600">Děkuji, že sis zahrál/a. Můžeš zkusit hrát znovu a zlepšit si skóre!</p>
            <button onclick="restartGame()" class="button bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-full text-lg">
                Hrát znovu
            </button>
        </div>
    </div>

    <script>
        // Data o organismech
        const organisms = [
            {
                speciesName: "Liška obecná",
                description: "Všežravá psovitá šelma s většinou rezavě hnědou srstí a hustým ocasem. Je jedním z nejrozšířenějších savců na světě.",
                class: "Savci (Mammalia)",
                order: "Šelmy (Carnivora)",
                group: "animal"
            },
            {
                speciesName: "Kapr obecný",
                description: "Sladkovodní ryba s šupinami a vousky kolem úst. Je hospodářsky významný a velmi rozšířený v rybnících.",
                class: "Paprskoploutvé ryby (Actinopterygii)",
                order: "Máloostní (Cypriniformes)",
                group: "animal"
            },
            {
                speciesName: "Sýkora koňadra",
                description: "Drobný pták s výrazným žlutým bříškem a svislým černým pruhem. Patří mezi nejběžnější ptáky v České republice.",
                class: "Ptáci (Aves)",
                order: "Pěvci (Passeriformes)",
                group: "animal"
            },
            {
                speciesName: "Užovka obojková",
                description: "Mírně jedovatý had s charakteristickým žlutým nebo oranžovým obojkem za hlavou. Obývá vlhká místa a často plave.",
                class: "Plazi (Reptilia)",
                order: "Šupinatí (Squamata)",
                group: "animal"
            },
            {
                speciesName: "Rosnička zelená",
                description: "Drobná žába s jasně zelenou kůží a přísavkami na prstech. Je aktivní v noci a často ji lze slyšet, jak skřehotá.",
                class: "Obojživelníci (Amphibia)",
                order: "Žáby (Anura)",
                group: "animal"
            },
            {
                speciesName: "Veverka obecná",
                description: "Malý hlodavec s dlouhým huňatým ocasem. Je známá sběrem a uskladňováním potravy, zejména ořechů a semen.",
                class: "Savci (Mammalia)",
                order: "Hlodavci (Rodentia)",
                group: "animal"
            },
            {
                speciesName: "Poštolka obecná",
                description: "Malý denní dravec z čeledi sokolovitých. Je proslulá svým třepotavým letem na místě, kterým vyhledává kořist.",
                class: "Ptáci (Aves)",
                order: "Sokoli (Falconiformes)",
                group: "animal"
            },
            {
                speciesName: "Roháč obecný",
                description: "Jeden z největších brouků v Evropě. Samečci mají nápadně velká, rohatá kusadla, která připomínají paroží.",
                class: "Hmyz (Insecta)",
                order: "Brouci (Coleoptera)",
                group: "animal"
            },
            {
                speciesName: "Mravenec lesní",
                description: "Sociální hmyz žijící ve velkých koloniích, které staví vysoké mraveniště. Jsou důležití pro ekosystém lesa.",
                class: "Hmyz (Insecta)",
                order: "Blanokřídlí (Hymenoptera)",
                group: "animal"
            },
            {
                speciesName: "Ještěrka obecná",
                description: "Malý plaz s tenkým tělem a dlouhým ocasem. V případě ohrožení ho dokáže odhodit a nechat dorůst.",
                class: "Plazi (Reptilia)",
                order: "Šupinatí (Squamata)",
                group: "animal"
            },
            {
                speciesName: "Sněženka podsněžník",
                description: "Jeden z prvních poslov jara s bílými, skloněnými květy.",
                class: "Jednoděložné (Liliopsida)",
                family: "Amarylkovité (Amaryllidaceae)",
                group: "plant"
            },
            {
                speciesName: "Pampeliška lékařská",
                description: "Běžná rostlina s jasně žlutými květy, které se později mění na bílá chmýří.",
                class: "Pravé dvouděložné (Eudicots)",
                family: "Hvězdnicovité (Asteraceae)",
                group: "plant"
            },
            {
                speciesName: "Sasanka hajní",
                description: "Bíle kvetoucí rostlina typická pro listnaté lesy, kvetoucí na jaře.",
                class: "Pravé dvouděložné (Eudicots)",
                family: "Pryskyřníkovité (Ranunculaceae)",
                group: "plant"
            },
            {
                speciesName: "Bříza bělokorá",
                description: "Strom s charakteristickou bílou kůrou a jemnými větvičkami.",
                class: "Pravé dvouděložné (Eudicots)",
                family: "Břízovité (Betulaceae)",
                group: "plant"
            },
            {
                speciesName: "Dub letní",
                description: "Mohutný listnatý strom, známý svými plody – žaludy. Roste velmi pomalu a dožívá se vysokého věku.",
                class: "Pravé dvouděložné (Eudicots)",
                family: "Bukovité (Fagaceae)",
                group: "plant"
            },
            {
                speciesName: "Buk lesní",
                description: "Mohutný listnatý strom s hladkou, šedou kůrou. Je dominantní dřevinou v českých lesích a jeho plody jsou bukvice.",
                class: "Pravé dvouděložné (Eudicots)",
                family: "Bukovité (Fagaceae)",
                group: "plant"
            },
            {
                speciesName: "Hřib smrkový",
                description: "Velmi ceněná jedlá houba s masivním, hnědým kloboukem.",
                class: "Vlastní houby (Agaricomycetes)",
                family: "Hřibovité (Boletaceae)",
                group: "fungi"
            },
            {
                speciesName: "Muchomůrka růžovka",
                description: "Jedlá houba s růžovým zabarvením a charakteristickým prstenem na noze. Pozor, často je zaměňována s muchomůrkou tygrovanou!",
                class: "Vlastní houby (Agaricomycetes)",
                family: "Pečárkovité (Agaricaceae)",
                group: "fungi"
            }
        ];

        // Seřazení organismů náhodně
        organisms.sort(() => Math.random() - 0.5);

        // Herní stav
        let currentRound = 1;
        let currentQuestionIndex = 0;
        let score = 0;
        let round2Organisms = [];
        let round3Organisms = [];
        let round4Organisms = [];
        let isTransitioning = false;
        
        // Pomocná data pro kolo 1
        const allAnimals = organisms.filter(o => o.group === 'animal');
        const allPlantsAndFungi = organisms.filter(o => o.group !== 'animal');

        // Elementy UI
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const endScreen = document.getElementById('end-screen');
        const roundTitle = document.getElementById('round-title');
        const speciesNameEl = document.getElementById('species-name');
        const speciesDescriptionEl = document.getElementById('species-description');
        const questionArea = document.getElementById('question-area');
        const feedbackMessage = document.getElementById('feedback-message');
        const nextButton = document.getElementById('next-button');
        const finalScoreEl = document.getElementById('final-score');

        // Funkce pro start hry
        function startGame() {
            startScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            gameScreen.classList.add('opacity-0');
            setTimeout(() => gameScreen.classList.remove('opacity-0'), 100);
            
            resetGame();
            loadQuestion();
        }

        // Funkce pro restart hry
        function restartGame() {
            endScreen.classList.add('hidden');
            startScreen.classList.remove('hidden');
            startScreen.classList.add('opacity-0');
            setTimeout(() => startScreen.classList.remove('opacity-0'), 100);
            organisms.sort(() => Math.random() - 0.5);
        }

        // Funkce pro reset herního stavu
        function resetGame() {
            currentRound = 1;
            currentQuestionIndex = 0;
            score = 0;
            isTransitioning = false;
            
            // Nastavení organismů pro kolo 2
            const ophistokonta = organisms.filter(o => o.group === 'animal' || o.group === 'fungi');
            round2Organisms = ophistokonta.sort(() => Math.random() - 0.5).slice(0, 7);

            // Nastavení organismů pro kolo 3
            round3Organisms = [
                organisms.find(o => o.speciesName === "Liška obecná"),
                organisms.find(o => o.speciesName === "Kapr obecný"),
                organisms.find(o => o.speciesName === "Sýkora koňadra"),
                organisms.find(o => o.speciesName === "Užovka obojková"),
                organisms.find(o => o.speciesName === "Rosnička zelená"),
                organisms.find(o => o.speciesName === "Sněženka podsněžník"),
                organisms.find(o => o.speciesName === "Pampeliška lékařská"),
                organisms.find(o => o.speciesName === "Sasanka hajní"),
                organisms.find(o => o.speciesName === "Bříza bělokorá"),
                organisms.find(o => o.speciesName === "Hřib smrkový")
            ];
            round3Organisms.sort(() => Math.random() - 0.5);

            // Nastavení organismů pro kolo 4
            const usedOrganisms = [...round2Organisms, ...round3Organisms];
            round4Organisms = organisms.filter(o => !usedOrganisms.includes(o));
            round4Organisms.sort(() => Math.random() - 0.5);
        }

        // Funkce pro načtení další otázky
        function nextQuestion() {
            feedbackMessage.classList.add('hidden');
            nextButton.classList.add('hidden');
            questionArea.innerHTML = '';

            if (isTransitioning) {
                isTransitioning = false;
                currentRound = 3;
                currentQuestionIndex = 0;
                loadQuestion();
                return;
            }

            currentQuestionIndex++;
            
            if (currentRound === 1 && currentQuestionIndex >= organisms.length) {
                currentQuestionIndex = 0;
                currentRound = 2;
            } else if (currentRound === 2 && currentQuestionIndex >= round2Organisms.length) {
                showArchaeplastidaInfo();
                return;
            } else if (currentRound === 3 && currentQuestionIndex >= round3Organisms.length) {
                currentQuestionIndex = 0;
                currentRound = 4;
            } else if (currentRound === 4 && currentQuestionIndex >= round4Organisms.length) {
                showEndScreen();
                return;
            }
            loadQuestion();
        }
        
        // Zobrazení přechodného textu
        function showArchaeplastidaInfo() {
            roundTitle.textContent = "Superskupina Archaeplastida";
            speciesNameEl.textContent = "Rostliny";
            speciesDescriptionEl.textContent = "Do této superskupiny patří rostliny, které se vyvinuly z řas, získaly chloroplasty a dokáží provádět fotosyntézu. Jejich buňky jsou zpevněné celulózní stěnou a patří sem organismy jako stromy, trávy a květiny.";
            questionArea.innerHTML = '';
            nextButton.classList.remove('hidden');
            nextButton.textContent = "Pokračovat do dalšího kola";
            isTransitioning = true;
        }

        // Funkce pro zobrazení závěrečné obrazovky
        function showEndScreen() {
            gameScreen.classList.add('hidden');
            endScreen.classList.remove('hidden');
            endScreen.classList.add('opacity-0');
            setTimeout(() => endScreen.classList.remove('opacity-0'), 100);
            const totalQuestions = organisms.length + round2Organisms.length + round3Organisms.length + round4Organisms.length;
            finalScoreEl.textContent = `Tvoje celkové skóre je ${score} z ${totalQuestions}.`;
        }

        // Funkce pro načtení otázky podle aktuálního kola
        function loadQuestion() {
            let organism;
            
            // Nastavení prvků UI pro každé kolo
            if (currentRound === 1) {
                organism = organisms[currentQuestionIndex];
                roundTitle.textContent = `Kolo 1: Vyber správný organismus (${currentQuestionIndex + 1}/${organisms.length})`;
                loadRound1(organism);
            } else if (currentRound === 2) {
                organism = round2Organisms[currentQuestionIndex];
                roundTitle.textContent = `Kolo 2: Zařaď Opisthokonta do tříd (${currentQuestionIndex + 1}/${round2Organisms.length})`;
                loadRound2(organism);
            } else if (currentRound === 3) {
                organism = round3Organisms[currentQuestionIndex];
                roundTitle.textContent = `Kolo 3: Přiřaď řád/čeleď (${currentQuestionIndex + 1}/${round3Organisms.length})`;
                loadRound3(organism);
            } else if (currentRound === 4) {
                organism = round4Organisms[currentQuestionIndex];
                roundTitle.textContent = `Kolo 4: Pojmenuj organismus (z představených organismů ve hře) (${currentQuestionIndex + 1}/${round4Organisms.length})`;
                loadRound4(organism);
            }
        }
        
        // Kolo 1: Vyber správný organismus
        function loadRound1(organism) {
            speciesNameEl.textContent = `${organism.group === 'animal' ? 'Řád' : 'Čeleď'}: ${organism.group === 'animal' ? organism.order.split(' (')[0] : organism.family.split(' (')[0]}`;
            speciesDescriptionEl.textContent = organism.description;

            const correctName = organism.speciesName;
            let otherOrganisms;
            if (organism.group === 'animal') {
                otherOrganisms = allAnimals.filter(o => o.speciesName !== correctName);
            } else {
                otherOrganisms = allPlantsAndFungi.filter(o => o.speciesName !== correctName);
            }

            const shuffledOthers = otherOrganisms.sort(() => Math.random() - 0.5);
            const incorrectNames = shuffledOthers.slice(0, 5).map(o => o.speciesName);

            const possibleAnswers = [correctName, ...incorrectNames];
            const shuffledAnswers = possibleAnswers.sort(() => Math.random() - 0.5);

            questionArea.innerHTML = '';
            shuffledAnswers.forEach(name => {
                const button = document.createElement('button');
                button.textContent = name;
                button.className = "button w-full bg-gray-200 hover:bg-gray-300 py-3 px-4 rounded-full font-semibold";
                button.onclick = () => checkAnswerRound1(button, name, correctName);
                questionArea.appendChild(button);
            });
        }
        
        function checkAnswerRound1(button, selectedName, correctName) {
            const isCorrect = selectedName === correctName;

            if (isCorrect) {
                score += 1;
                feedbackMessage.textContent = "Správně! Získáváš 1 bod.";
                feedbackMessage.className = "message-box correct text-center p-4 mt-6 rounded-lg text-lg font-semibold";
            } else {
                feedbackMessage.textContent = `Špatně. Správná odpověď je ${correctName}.`;
                feedbackMessage.className = "message-box incorrect text-center p-4 mt-6 rounded-lg text-lg font-semibold";
            }

            feedbackMessage.classList.remove('hidden');
            nextButton.classList.remove('hidden');
            disableButtons();
        }

        // Kolo 2: Zařazení do tříd (Opisthokonta)
        function loadRound2(organism) {
            speciesNameEl.textContent = organism.speciesName;
            speciesDescriptionEl.textContent = "";
            
            // Pevně dané možnosti pro druhé kolo
            const possibleClasses = [
                "Hmyz (Insecta)",
                "Paprskoploutvé ryby (Actinopterygii)",
                "Ptáci (Aves)",
                "Plazi (Reptilia)",
                "Vlastní houby (Agaricomycetes)",
                "Savci (Mammalia)",
                "Obojživelníci (Amphibia)"
            ];

            const shuffledClasses = possibleClasses.sort(() => Math.random() - 0.5);

            shuffledClasses.forEach(cls => {
                const button = document.createElement('button');
                button.textContent = cls;
                button.className = "button w-full bg-gray-200 hover:bg-gray-300 py-3 px-4 rounded-full font-semibold";
                button.onclick = () => checkAnswerRound2(button, cls, organism.class);
                questionArea.appendChild(button);
            });
        }
        
        // Kolo 3: Přiřaď řád/čeleď
        function loadRound3(organism) {
            speciesNameEl.textContent = organism.speciesName;
            speciesDescriptionEl.textContent = "";
            
            // Pevně dané možnosti pro třetí kolo
            const possibleAnswers = [
                "Šelmy (Carnivora)",
                "Máloostní (Cypriniformes)",
                "Pěvci (Passeriformes)",
                "Šupinatí (Squamata)",
                "Žáby (Anura)",
                "Amarylkovité (Amaryllidaceae)",
                "Hvězdnicovité (Asteraceae)",
                "Pryskyřníkovité (Ranunculaceae)",
                "Břízovité (Betulaceae)",
                "Hřibovité (Boletaceae)"
            ];

            const shuffledAnswers = possibleAnswers.sort(() => Math.random() - 0.5);

            shuffledAnswers.forEach(ans => {
                const button = document.createElement('button');
                button.textContent = ans;
                button.className = "button w-full bg-gray-200 hover:bg-gray-300 py-3 px-4 rounded-full font-semibold";
                button.onclick = () => checkAnswerRound3(button, ans, organism);
                questionArea.appendChild(button);
            });
        }

        // Kolo 4: Napiš název organismu
        function loadRound4(organism) {
            speciesNameEl.textContent = `Třída: ${organism.class.split(' (')[0]}`;
            speciesDescriptionEl.textContent = `${organism.group === 'animal' ? 'Řád' : 'Čeleď'}: ${organism.group === 'animal' ? organism.order.split(' (')[0] : organism.family.split(' (')[0]}`;
            
            // Přidání popisu organismu do 4. kola
            const descriptionParagraph = document.createElement('p');
            descriptionParagraph.textContent = organism.description;
            descriptionParagraph.className = "text-gray-600 italic mb-4";
            questionArea.appendChild(descriptionParagraph);

            const inputGroup = document.createElement('div');
            inputGroup.className = "flex flex-col sm:flex-row gap-4";
            
            const input = document.createElement('input');
            input.type = "text";
            input.id = "species-input";
            input.placeholder = "Napište zde název organismu...";
            input.className = "w-full p-3 rounded-full border-2 border-gray-300 focus:outline-none focus:border-blue-500";
            
            const submitButton = document.createElement('button');
            submitButton.textContent = "Zkontrolovat";
            submitButton.className = "button bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-full";
            submitButton.onclick = () => checkAnswerRound4(organism);
            
            inputGroup.appendChild(input);
            inputGroup.appendChild(submitButton);
            questionArea.appendChild(inputGroup);
        }

        // Kontrola odpovědi - Kolo 2
        function checkAnswerRound2(button, selectedClass, correctClass) {
            const isCorrect = selectedClass === correctClass;
            
            if (isCorrect) {
                score += 1;
                feedbackMessage.textContent = "Správně! Získáváš 1 bod.";
                feedbackMessage.className = "message-box correct text-center p-4 mt-6 rounded-lg text-lg font-semibold";
            } else {
                feedbackMessage.textContent = `Špatně. Správná odpověď je ${correctClass}.`;
                feedbackMessage.className = "message-box incorrect text-center p-4 mt-6 rounded-lg text-lg font-semibold";
            }
            
            feedbackMessage.classList.remove('hidden');
            nextButton.classList.remove('hidden');
            disableButtons();
        }

        // Kontrola odpovědi - Kolo 3
        function checkAnswerRound3(button, selectedAnswer, organism) {
            const isCorrect = selectedAnswer === (organism.group === 'animal' ? organism.order : organism.family);
            
            if (isCorrect) {
                score += 1;
                feedbackMessage.textContent = "Správně! Získáváš 1 bod.";
                feedbackMessage.className = "message-box correct text-center p-4 mt-6 rounded-lg text-lg font-semibold";
            } else {
                const correctAnswer = organism.group === 'animal' ? organism.order : organism.family;
                feedbackMessage.textContent = `Špatně. Správná odpověď je ${correctAnswer}.`;
                feedbackMessage.className = "message-box incorrect text-center p-4 mt-6 rounded-lg text-lg font-semibold";
            }
            
            feedbackMessage.classList.remove('hidden');
            nextButton.classList.remove('hidden');
            disableButtons();
        }

        // Kontrola odpovědi - Kolo 4
        function checkAnswerRound4(organism) {
            const userInput = document.getElementById('species-input').value.trim();
            
            const normalizedUserInput = userInput.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
            const correctNormalizedName = organism.speciesName.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");

            const isCorrect = normalizedUserInput === correctNormalizedName;

            if (isCorrect) {
                score += 1;
                feedbackMessage.textContent = `Skvěle! Správně jsi napsal/a ${organism.speciesName}. Získáváš 1 bod.`;
                feedbackMessage.className = "message-box correct text-center p-4 mt-6 rounded-lg text-lg font-semibold";
            } else {
                feedbackMessage.textContent = `Bohužel, tvá odpověď není správná. Správný název je: ${organism.speciesName}.`;
                feedbackMessage.className = "message-box incorrect text-center p-4 mt-6 rounded-lg text-lg font-semibold";
            }
            
            feedbackMessage.classList.remove('hidden');
            nextButton.classList.remove('hidden');
        }

        // Funkce pro zakázání tlačítek po výběru
        function disableButtons() {
            const buttons = questionArea.querySelectorAll('button');
            buttons.forEach(button => {
                button.disabled = true;
            });
        }
    </script>
</body>
</html>
